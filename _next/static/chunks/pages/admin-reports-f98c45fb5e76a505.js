(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{93626:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r,a,s,o,i,c=n(50029),l=n(59499),u=n(71383),p=n(87794),d=n.n(p),f=n(67294),h=n(99603),x=n(59417),g=n(85330),b=n(59912),m=n(56839),v=n(21963),j=n(84105),w=new Date,y="".concat(w.getFullYear()).concat(w.getMonth()+1).concat(w.getDate()).concat(w.getHours()).concat(w.getMinutes()),_=(r=(0,c.Z)(d().mark(function e(){var t,n,r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.e.get("reports/all-standard-integrations").then(function(e){return e.data});case 3:t=e.sent,n=j.P6.json_to_sheet(t),r=j.P6.book_new(),j.P6.book_append_sheet(r,n,"All standard integrations"),j.NC(r,"all-standard-integrations-".concat(y,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,v.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(){return r.apply(this,arguments)}),k=(a=(0,c.Z)(d().mark(function e(t,n){var r,a,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.e.get("reports/database-tables",{params:{type:t,orderBy:n}}).then(function(e){return e.data});case 3:r=e.sent,a=j.P6.json_to_sheet(r),s=j.P6.book_new(),j.P6.book_append_sheet(s,a,"All ".concat(t)),j.NC(s,"all-".concat(t.toLowerCase(),"-").concat(y,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,v.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(e,t){return a.apply(this,arguments)}),O=n(85444),P=n(88916),C=n(76691),E=n(85893);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach(function(t){(0,l.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var N=O.default.div(s||(s=(0,u.Z)(["\n  border-bottom: 1px solid #707070;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n"]))),q=O.default.div(o||(o=(0,u.Z)(["\n  display: flex;\n"]))),T=O.default.div(i||(i=(0,u.Z)(["\n  padding-top: 5px;\n  margin-left: 20px;\n"]))),z=[{maxWidth:900,marginTop:0,marginLeft:10,marginRight:10,marginUnit:"px",horizontalAlign:"none"},{width:480,marginTop:0,marginLeft:2.5,marginRight:2.5,marginUnit:"rem",horizontalAlign:"none"}],S=[{value:"all-requests",label:"Integrations"},{value:"all-users",label:"Users"},{value:"all-teams",label:"Teams"},{value:"all-events",label:"Events"}],A={"all-requests":"Requests","all-users":"Users","all-teams":"Teams","all-events":"Events"},R={Requests:"id",Users:"id",Teams:"id",Events:"request_id"};function U(e){return""==e.type?(0,E.jsx)(E.Fragment,{}):(0,E.jsx)(C.Kk,{icon:x.q7m,role:"button",onClick:e.handleClick,title:"Download",size:"lg"})}function F(e){e.session;var t,n,r=(0,f.useState)(!1),a=r[0],s=r[1],o=(0,f.useState)(""),i=o[0],l=o[1],u=(t=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,_();case 3:s(!1);case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),p=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,k(A[i],R[A[i]]);case 3:s(!1);case 4:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,E.jsxs)(b.Z,{rules:z,children:[(0,E.jsx)("h2",{children:"Reports"}),(0,E.jsx)(N,{children:a?(0,E.jsx)(m.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:a}):(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(g.zx,{variant:"primary",type:"button",className:"text-center",onClick:u,children:[(0,E.jsx)("span",{children:"All Standard Integrations\xa0"}),(0,E.jsx)(h.G,{icon:x.q7m})]})})}),(0,E.jsx)("h2",{children:"Database"}),a?(0,E.jsx)(m.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:a}):(0,E.jsxs)(q,{children:[(0,E.jsx)(function(){return(0,E.jsx)(P.ZP,{value:S.filter(function(e){return e.value===i}),options:S,onChange:function(e){return l(e.value)},maxMenuHeight:300,placeholder:"Select table...",styles:{control:function(e){return D(D({},e),{},{width:"250px"})},menu:function(e){return D(D({},e),{},{width:"250px"})}}})},{}),(0,E.jsx)(T,{children:(0,E.jsx)(U,{type:i,handleClick:p})})]})]})}},36484:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-reports",function(){return n(93626)}])},20067:function(){},72061:function(){}},function(e){e.O(0,[251,693,553,691,774,888,179],function(){return e(e.s=36484)}),_N_E=e.O()}]);